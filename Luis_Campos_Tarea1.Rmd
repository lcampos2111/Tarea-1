---
title: "Thematics"
output:
  html_document:
    df_print: paged
---

## Layers available on GPKG:

```{r}
rm(list = ls())

WorldLink="https://github.com/lcampos2111/Tarea-1/raw/refs/heads/main/World_8857.gpkg/"
library(sf)
st_layers(WorldLink)
```

## Reading some layers:

```{r, message=FALSE}
World <- st_read(WorldLink, layer = "continent")
WorldMob_ddm <- st_read(WorldLink, layer = "value_ddm")
WorldMob_psm <- st_read(WorldLink, layer = "value_psm")

```

## Checking CRS

```{r}
st_crs(World)$epsg
```

# THE BASE
```{r}
library(ggplot2)
library(scales)

ggplot() +
  #call map
  geom_sf(data = World) + 
  # adjust datum 
  coord_sf(datum = st_crs(World)) + 
  # custom X and Y axes
  scale_x_continuous(labels = label_number(scale = 1/1000, suffix = " km")) +
  scale_y_continuous(labels = label_number(scale = 1/1000, suffix = " km")) +
  labs(x = "Easting", y = "Northing") #labels
```
# DDM - static

```{r}
ggplot() + theme_light() +
  #base
  geom_sf(data = World,fill="white",color="grey80") +
  # layer
  geom_sf(data=WorldMob_ddm,
          alpha=0.1,#transparancy
          shape=20,
          size=1,
          color="red")+
  coord_sf(datum = st_crs(World)) # at the end of maps
  
```
# DDM - interactive

```{r}
library(leaflet)
# needs geographic CRS
ddm_4326 <- st_transform(WorldMob_ddm, crs = 4326)

leaflet() %>%
  addTiles() %>%  # base map
  addCircleMarkers(data = ddm_4326,
                   color="red",
                   radius = 0.01,
                   opacity = 0.1)
```

Almost the same:

```{r}
leaflet() %>%
  addProviderTiles(providers$CartoDB.Positron)  %>%  # names in english
  addCircleMarkers(data = ddm_4326,
                   color="red",
                   radius = 0.01,
                   opacity = 0.1)
```


# PSM - static

```{r}
ggplot() + theme_light() +
  #base
  geom_sf(data = World,fill="white",color="grey80") +
  # layer
  geom_sf(data=WorldMob_psm,
          shape=20,
          color="red",aes(size=size))+
  coord_sf(datum = st_crs(World)) # at the end of maps
  
```
# PSM - interactive

```{r}
# CRS for leaflet
psm_4326 <- st_transform(WorldMob_psm, crs = 4326)


leaflet() %>%
  addProviderTiles(providers$CartoDB.Positron)  %>%  
  addCircleMarkers(data = psm_4326,
                   # fillColor = "red",
                   # stroke = T, #border
                   # color="red", #border color
                   # fillOpacity = 1,
                   label = ~Country,
                   radius = ~size/10)
```
